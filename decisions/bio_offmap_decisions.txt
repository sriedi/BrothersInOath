###GRACE INTERACTION DECISIONS FOR HRE###

#Add the decisions in a nice order which will make sense in the menu! For example, ranked by cost/reward.


#PAYING TRIBUTE DECISIONS (GAIN GRACE)
offmap_decisions = {

	hre_grace_send_gift = {
		only_playable = yes
		button_name = offmap_gifts
		ai_check_interval = 120

		potential = {
			is_offmap_tag = offmap_hre
		}

		from_potential = {
			mercenary = no
			holy_order = no
			is_landed = yes
		}

		allow = {
			show_only_failed_conditions = yes
			FROM = {
				show_scope_change = no
				scaled_wealth = { value = 4 min = 200 }
				custom_tooltip = {
					text = hre_grace_send_gift_allow_tt 
					NOT = { has_character_modifier = hre_grace_send_gift_timer }
				}
				prisoner = no
				NOT = { trait = incapable }
				is_inaccessible_trigger = no
			}
			
			hre_offmap_tribute_decisions_enabled_trigger = yes
		}
		effect = {
			FROM = {
				sound_effect = china_grace_gain
				scaled_wealth = { value = -4 min = -200 } #If this changes the ai chances should probably be adjusted
				hidden_effect = {
					add_character_modifier = {
						hidden = yes
						name = hre_grace_send_gift_timer
						years = 15 #Change chinese_grace_send_gift_allow_tt if this number changes
					} 
				}
			}
			hidden_effect = { offmap_hre = { governor = { character_event = { id = BIO.20021 } } } }
		}

		revoke_allowed = {
			always = no
		}

		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.66 # slow down
			}
			modifier = {
				factor = 0.1
				FROM = { NOT = { monthly_income = 11 } } #I.e. it would take more than 4 years to collect the 500 gold
			}
		}
	}

	hre_grace_supply_mercs = {
		only_playable = yes
		button_name = offmap_gifts
		ai_check_interval = 36
    
		potential = {
			is_offmap_tag = offmap_hre
		}
	
		from_potential = {
			mercenary = no
			holy_order = no
			is_landed = yes
		}
    
		allow = {
			show_only_failed_conditions = yes
			FROM = {
				show_scope_change = no
				custom_tooltip = {
					text = hre_grace_supply_mercs_not_already_supplying_tt
					NOT = {
						has_character_modifier = hre_supply_mercs
					}
				}
				custom_tooltip = {
					text = hre_grace_supply_mercs_stopped_supplying_tt
					NOT = {
						has_character_modifier = hre_supply_mercs_cd
					}
				}
				war = no
				prisoner = no
				NOT = { trait = incapable }
				is_inaccessible_trigger = no
			}
			hre_offmap_tribute_decisions_enabled_trigger = yes
		}
    
		effect = {
			set_hre_supply_mercs_effect = yes
			hidden_effect = { offmap_hre = { governor = { character_event = { id = JD.3040 } } } }
			FROM = {
				hre_supply_mercs = yes
				sound_effect = china_grace_gain
				tooltip = {
					add_character_modifier = {
						name = hre_supply_mercs
						duration = -1
						inherit = yes
					}
					if = {
						limit = {
							liked_by_offmap = {
								type = offmap_hre
							}
							NOT = {
								disliked_by_offmap = {
									type = offmap_hre
								}
							}
						}
						add_offmap_currency = {
							offmap = offmap_hre
							value = 150
						}
						e_reichsvogtei = {
							show_scope_change = no
							offmap_power = {
								show_scope_change = no
								custom_tooltip = { text = likes_tt }
							}
						}
					}
					if = {
						limit = {
							disliked_by_offmap = {
								type = offmap_hre
							}
							NOT = {
								liked_by_offmap = {
									type = offmap_hre
								}
							}
						}
						add_offmap_currency = {
							offmap = offmap_hre
							value = 50
						}
						e_reichsvogtei = {
							show_scope_change = no
							offmap_power = {
								show_scope_change = no
								custom_tooltip = { text = dislikes_tt }
							}
						}
					}
					if = {
						limit = {
							liked_by_offmap = {
								type = offmap_hre
							}
							disliked_by_offmap = {
								type = offmap_hre
							}
						}
						add_offmap_currency = {
							offmap = offmap_hre
							value = 150
						}
						e_reichsvogtei = {
							show_scope_change = no
							offmap_power = {
								show_scope_change = no
								custom_tooltip = { text = likes_but_dislikes_tt }
							}
						}
					}
					if = {
						limit = {
							NOR = {
								liked_by_offmap = {
									type = offmap_hre
								}
								disliked_by_offmap = {
									type = offmap_hre
								}
							}
						}
						add_offmap_currency = {
							offmap = offmap_hre
							value = 100
						}
					}
				}
			}
		}
    
		revoke_allowed = {
			always = no
		}
    
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				FROM = {
					NOR = {
						trait = humble
						trait = shy
						trait = craven
					}
				}
			}
			modifier = {
				factor = 0
				FROM = {
					OR = {
						trait = ambitious
						trait = proud
					}
				}
			}
			modifier = {
				factor = 0
				FROM = {
					primary_title = {
						title = e_mongol_empire
					}
				}
			}
		}
	}
	
	hre_grace_stop_supply_mercs = {
		only_playable = yes
		button_name = offmap_gifts
		ai_check_interval = 36
    
		potential = {
			is_offmap_tag = offmap_hre
		}
	
		from_potential = {
			mercenary = no
			holy_order = no
			is_landed = yes
			has_character_modifier = hre_grace_supply_mercs
		}
    
		allow = {
			show_only_failed_conditions = yes
			FROM = {
				show_scope_change = no
				has_character_modifier = hre_supply_mercs
			}
		}
    
		effect = {
			set_hre_stopp_supply_mercs_effect = yes
			#hidden_effect = { offmap_hre = { governor = { character_event = { id = JD.3040 } } } }
			FROM = {
				sound_effect = china_angered_emperor
				remove_character_modifier = hre_supply_mercs
				if = {
					limit = {
						liked_by_offmap = {
							type = offmap_hre
						}
						NOT = {
							disliked_by_offmap = {
								type = offmap_hre
							}
						}
					}
					add_offmap_currency = {
						offmap = offmap_hre
						value = -150
					}
					e_china_west_governor = {
						show_scope_change = no
						offmap_power = {
							show_scope_change = no
							custom_tooltip = { text = likes_tt }
						}
					}
				}
				if = {
					limit = {
						disliked_by_offmap = {
							type = offmap_hre
						}
						NOT = {
							liked_by_offmap = {
								type = offmap_hre
							}
						}
					}
					add_offmap_currency = {
						offmap = offmap_hre
						value = -50
					}
					e_china_west_governor = {
						show_scope_change = no
						offmap_power = {
							show_scope_change = no
							custom_tooltip = { text = dislikes_tt }
						}
					}
				}
				if = {
					limit = {
						liked_by_offmap = {
							type = offmap_hre
						}
						disliked_by_offmap = {
							type = offmap_hre
						}
					}
					add_offmap_currency = {
						offmap = offmap_hre
						value = -150
					}
					e_china_west_governor = {
						show_scope_change = no
						offmap_power = {
							show_scope_change = no
							custom_tooltip = { text = likes_but_dislikes_tt }
						}
					}
				}
				if = {
					limit = {
						NOR = {
							liked_by_offmap = {
								type = offmap_hre
							}
							disliked_by_offmap = {
								type = offmap_hre
							}
						}
					}
					add_offmap_currency = {
						offmap = offmap_hre
						value = -100
					}
				}
			}
		}
    
		revoke_allowed = {
			always = no
		}
    
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				FROM = {
					OR = {
						trait = humble
						trait = shy
						trait = craven
					}
				}
			}
			modifier = {
				factor = 0
				FROM = {
					NOR = {
						trait = proud
						trait = ambitious
						trait = brave
					}
				}
			}
		}
	}

}
